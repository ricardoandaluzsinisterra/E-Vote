
INFO:db_ops_service.main:OTP stored for hafsamoin14@gmail.com (type=admin, expires in 600s)
ERROR:auth_service.main:❌ Failed to send OTP email: timed out
ERROR:auth_service.main:❌ SMTP send failed: timed out
INFO:auth_service.main:[FALLBACK] OTP for hafsamoin14@gmail.com (admin): 855736
WARNING:auth_service.main:Failed to send OTP email for hafsamoin14@gmail.com: timed out
INFO:auth_service.main:OTP sent to hafsamoin14@gmail.com (type=admin)
INFO:auth_service.main:Kafka producer stopped
INFO:database.connection:Database connection successful to postgres:5432
INFO:database.connection:Redis connection successful to redis:6379 db=0
INFO:__main__:Connected to Postgres/Redis via DatabaseManager
INFO:__main__:Ensured events table exists
INFO:__main__:Ensured users table exists
INFO:aiokafka.consumer.subscription_state:Updating subscribed topics to: frozenset({'user.redis.ops', 'user.postgres.ops'})
WARNING:aiokafka.cluster:Topic user.redis.ops is not available during auto-create initialization
WARNING:aiokafka.cluster:Topic user.postgres.ops is not available during auto-create initialization
WARNING:aiokafka.cluster:Topic user.redis.ops is not available during auto-create initialization
WARNING:aiokafka.cluster:Topic user.postgres.ops is not available during auto-create initialization
INFO:db_ops_service.database.connection:Database connection successful to postgres:5432
INFO:db_ops_service.database.connection:Redis connection successful to redis:6379 db=0
ERROR:aiokafka.consumer.group_coordinator:Group Coordinator Request failed: [Error 15] CoordinatorNotAvailableError
ERROR:aiokafka.consumer.group_coordinator:Group Coordinator Request failed: [Error 15] CoordinatorNotAvailableError
ERROR:aiokafka.consumer.group_coordinator:Group Coordinator Request failed: [Error 15] CoordinatorNotAvailableError
ERROR:aiokafka.consumer.group_coordinator:Group Coordinator Request failed: [Error 15] CoordinatorNotAvailableError
INFO:aiokafka.consumer.group_coordinator:Discovered coordinator 1 for group db_ops_group
INFO:aiokafka.consumer.group_coordinator:Revoking previously assigned partitions set() for group db_ops_group
INFO:aiokafka.consumer.group_coordinator:(Re-)joining group db_ops_group
INFO:auth_service.main:Kafka producer started (bootstrap=kafka:9092)
INFO:aiokafka.consumer.group_coordinator:Joined group 'db_ops_group' (generation 1) with member_id aiokafka-0.8.0-52e3fb30-84cb-423e-ae33-1129bbd66cc1
INFO:aiokafka.consumer.group_coordinator:Elected group leader -- performing partition assignments using roundrobin
INFO:aiokafka.consumer.group_coordinator:Successfully synced group db_ops_group with generation 1
INFO:aiokafka.consumer.group_coordinator:Setting newly assigned partitions {TopicPartition(topic='user.redis.ops', partition=0), TopicPartition(topic='user.postgres.ops', partition=0)} for group db_ops_group
INFO:__main__:Kafka consumer started (bootstrap=kafka:9092, topics=['user.postgres.ops', 'user.redis.ops'], group=db_ops_group)
INFO:db_ops_service.main:OTP stored for hafsamoin14@gmail.com (type=admin, expires in 600s)
INFO:auth_service.main:✅ Email sent successfully to hafsamoin14@gmail.com via smtp.gmail.com:587
INFO:auth_service.main:✅ OTP email sent successfully via SMTP to hafsamoin14@gmail.com
INFO:auth_service.main:OTP sent to hafsamoin14@gmail.com (type=admin)
INFO:db_ops_service.main:OTP stored for hafsamoin14@gmail.com (type=admin, expires in 600s)
INFO:auth_service.main:✅ Email sent successfully to hafsamoin14@gmail.com via smtp.gmail.com:587
INFO:auth_service.main:✅ OTP email sent successfully via SMTP to hafsamoin14@gmail.com
INFO:auth_service.main:OTP sent to hafsamoin14@gmail.com (type=admin)
INFO:db_ops_service.main:OTP verified successfully for hafsamoin14@gmail.com (type=admin)
INFO:auth_service.main:OTP verified successfully for hafsamoin14@gmail.com (type=admin)
INFO:auth_service.main:Kafka producer stopped
INFO:database.connection:Database connection successful to postgres:5432
INFO:database.connection:Redis connection successful to redis:6379 db=0
INFO:__main__:Connected to Postgres/Redis via DatabaseManager
INFO:__main__:Ensured events table exists
INFO:__main__:Ensured users table exists
INFO:aiokafka.consumer.subscription_state:Updating subscribed topics to: frozenset({'user.postgres.ops', 'user.redis.ops'})
WARNING:aiokafka.cluster:Topic user.redis.ops is not available during auto-create initialization
WARNING:aiokafka.cluster:Topic user.postgres.ops is not available during auto-create initialization
WARNING:aiokafka.cluster:Topic user.redis.ops is not available during auto-create initialization
WARNING:aiokafka.cluster:Topic user.postgres.ops is not available during auto-create initialization
ERROR:aiokafka.consumer.group_coordinator:Group Coordinator Request failed: [Error 15] CoordinatorNotAvailableError
INFO:db_ops_service.database.connection:Database connection successful to postgres:5432
INFO:db_ops_service.database.connection:Redis connection successful to redis:6379 db=0
ERROR:aiokafka.consumer.group_coordinator:Group Coordinator Request failed: [Error 15] CoordinatorNotAvailableError
ERROR:aiokafka.consumer.group_coordinator:Group Coordinator Request failed: [Error 15] CoordinatorNotAvailableError
ERROR:aiokafka.consumer.group_coordinator:Group Coordinator Request failed: [Error 15] CoordinatorNotAvailableError
ERROR:aiokafka.consumer.group_coordinator:Group Coordinator Request failed: [Error 15] CoordinatorNotAvailableError
INFO:aiokafka.consumer.group_coordinator:Discovered coordinator 1 for group db_ops_group
INFO:aiokafka.consumer.group_coordinator:Revoking previously assigned partitions set() for group db_ops_group
INFO:aiokafka.consumer.group_coordinator:(Re-)joining group db_ops_group
INFO:auth_service.main:Kafka producer started (bootstrap=kafka:9092)
INFO:aiokafka.consumer.group_coordinator:Joined group 'db_ops_group' (generation 1) with member_id aiokafka-0.8.0-09bdafdb-09cb-40df-9b4b-9a17db6160b7
INFO:aiokafka.consumer.group_coordinator:Elected group leader -- performing partition assignments using roundrobin
INFO:aiokafka.consumer.group_coordinator:Successfully synced group db_ops_group with generation 1
INFO:aiokafka.consumer.group_coordinator:Setting newly assigned partitions {TopicPartition(topic='user.postgres.ops', partition=0), TopicPartition(topic='user.redis.ops', partition=0)} for group db_ops_group
INFO:__main__:Kafka consumer started (bootstrap=kafka:9092, topics=['user.postgres.ops', 'user.redis.ops'], group=db_ops_group)
ERROR:auth_service.main:Failed to call db_ops_service for pre-create lookup: 
Traceback (most recent call last):
  File "/app/auth_service/main.py", line 102, in register_user
    raise HTTPException(status_code=status.HTTP_409_CONFLICT, detail="User with this email already exists")
fastapi.exceptions.HTTPException
ERROR:auth_service.main:Failed to call db_ops_service for pre-create lookup: 
Traceback (most recent call last):
  File "/app/auth_service/main.py", line 102, in register_user
    raise HTTPException(status_code=status.HTTP_409_CONFLICT, detail="User with this email already exists")
fastapi.exceptions.HTTPException
ERROR:auth_service.main:Failed to call db_ops_service for pre-create lookup: 
Traceback (most recent call last):
  File "/app/auth_service/main.py", line 102, in register_user
    raise HTTPException(status_code=status.HTTP_409_CONFLICT, detail="User with this email already exists")
fastapi.exceptions.HTTPException
INFO:auth_service.main:Kafka producer stopped
INFO:auth_service.main:Kafka producer started (bootstrap=kafka:9092)
INFO:db_ops_service.main:OTP stored for hafsamoin14@gmail.com (type=admin, expires in 600s)
INFO:auth_service.main:✅ Email sent successfully to hafsamoin14@gmail.com via smtp.gmail.com:587
INFO:auth_service.main:✅ OTP email sent successfully via SMTP to hafsamoin14@gmail.com
INFO:auth_service.main:OTP sent to hafsamoin14@gmail.com (type=admin)
INFO:db_ops_service.main:OTP verified successfully for hafsamoin14@gmail.com (type=admin)
INFO:db_ops_service.main:User marked as verified: hafsamoin14@gmail.com
INFO:auth_service.main:Admin account verified and activated: hafsamoin14@gmail.com
INFO:db_ops_service.main:OTP stored for hafsamoin14@gmail.com (type=admin, expires in 600s)
INFO:auth_service.main:✅ Email sent successfully to hafsamoin14@gmail.com via smtp.gmail.com:587
INFO:auth_service.main:✅ OTP email sent successfully via SMTP to hafsamoin14@gmail.com
INFO:auth_service.main:OTP sent to hafsamoin14@gmail.com (type=admin)
INFO:db_ops_service.main:OTP verified successfully for hafsamoin14@gmail.com (type=admin)
INFO:db_ops_service.main:User marked as verified: hafsamoin14@gmail.com
INFO:auth_service.main:Admin account verified and activated: hafsamoin14@gmail.com
INFO:db_ops_service.main:Candidate stored: Alice Smith (id=1)
INFO:db_ops_service.main:Candidate stored: Bob Jones (id=2)
INFO:auth_service.main:Candidate upload complete: 2 uploaded, 0 failed
INFO:db_ops_service.main:Voter record stored: voter1@example.com
INFO:auth_service.main:✅ Email sent successfully to voter1@example.com via smtp.gmail.com:587
INFO:auth_service.main:✅ Registration email sent to voter1@example.com
INFO:auth_service.main:Registration email sent to voter1@example.com
INFO:db_ops_service.main:Voter record stored: voter2@example.com
INFO:auth_service.main:✅ Email sent successfully to voter2@example.com via smtp.gmail.com:587
INFO:auth_service.main:✅ Registration email sent to voter2@example.com
INFO:auth_service.main:Registration email sent to voter2@example.com
INFO:auth_service.main:Voter upload complete: 2 uploaded, 0 failed
INFO:db_ops_service.main:Voter record stored: hafsamoin14@gmail.com
INFO:auth_service.main:✅ Email sent successfully to hafsamoin14@gmail.com via smtp.gmail.com:587
INFO:auth_service.main:✅ Registration email sent to hafsamoin14@gmail.com
INFO:auth_service.main:Registration email sent to hafsamoin14@gmail.com
INFO:auth_service.main:Voter upload complete: 1 uploaded, 0 failed
INFO:db_ops_service.main:Voter record stored: hafsamoin12@yahoo.com
INFO:auth_service.main:✅ Email sent successfully to hafsamoin12@yahoo.com via smtp.gmail.com:587
INFO:auth_service.main:✅ Registration email sent to hafsamoin12@yahoo.com
INFO:auth_service.main:Registration email sent to hafsamoin12@yahoo.com
INFO:db_ops_service.main:Voter record stored: harenemo1520@gmail.com
INFO:auth_service.main:✅ Email sent successfully to harenemo1520@gmail.com via smtp.gmail.com:587
INFO:auth_service.main:✅ Registration email sent to harenemo1520@gmail.com
INFO:auth_service.main:Registration email sent to harenemo1520@gmail.com
INFO:db_ops_service.main:Voter record stored: hafsamoin65@gmail.com
INFO:auth_service.main:✅ Email sent successfully to hafsamoin65@gmail.com via smtp.gmail.com:587
INFO:auth_service.main:✅ Registration email sent to hafsamoin65@gmail.com
INFO:auth_service.main:Registration email sent to hafsamoin65@gmail.com
INFO:auth_service.main:Voter upload complete: 3 uploaded, 0 failed
INFO:db_ops_service.main:Voter account created: hafsamoin12@yahoo.com
INFO:auth_service.main:Voter registered successfully: hafsamoin12@yahoo.com
INFO:auth_service.main:Kafka producer stopped
INFO:auth_service.main:Kafka producer started (bootstrap=kafka:9092)
INFO:auth_service.main:Kafka producer stopped
INFO:db_ops_service.database.connection:Database connection successful to postgres:5432
INFO:db_ops_service.database.connection:Redis connection successful to redis:6379 db=0
INFO:auth_service.main:Kafka producer started (bootstrap=kafka:9092)
INFO:auth_service.main:Kafka producer stopped
INFO:db_ops_service.database.connection:Database connection successful to postgres:5432
INFO:db_ops_service.database.connection:Redis connection successful to redis:6379 db=0
INFO:auth_service.main:Kafka producer started (bootstrap=kafka:9092)
INFO:db_ops_service.main:OTP rate limit check passed for test-rate-limit@example.com (type=admin, remaining=2)
INFO:db_ops_service.main:OTP stored for test-rate-limit@example.com (type=admin, expires in 600s)
INFO:auth_service.main:✅ Email sent successfully to test-rate-limit@example.com via smtp.gmail.com:587
INFO:auth_service.main:✅ OTP email sent successfully via SMTP to test-rate-limit@example.com
INFO:auth_service.main:OTP sent to test-rate-limit@example.com (type=admin)
INFO:db_ops_service.main:OTP rate limit check passed for test-rate-limit@example.com (type=admin, remaining=1)
INFO:db_ops_service.main:OTP stored for test-rate-limit@example.com (type=admin, expires in 600s)
INFO:auth_service.main:✅ Email sent successfully to test-rate-limit@example.com via smtp.gmail.com:587
INFO:auth_service.main:✅ OTP email sent successfully via SMTP to test-rate-limit@example.com
INFO:auth_service.main:OTP sent to test-rate-limit@example.com (type=admin)
INFO:db_ops_service.main:OTP rate limit check passed for test-rate-limit@example.com (type=admin, remaining=0)
INFO:db_ops_service.main:OTP stored for test-rate-limit@example.com (type=admin, expires in 600s)
INFO:auth_service.main:✅ Email sent successfully to test-rate-limit@example.com via smtp.gmail.com:587
INFO:auth_service.main:✅ OTP email sent successfully via SMTP to test-rate-limit@example.com
INFO:auth_service.main:OTP sent to test-rate-limit@example.com (type=admin)
WARNING:db_ops_service.main:OTP rate limit exceeded for test-rate-limit@example.com (type=admin)
INFO:db_ops_service.main:OTP rate limit check passed for hafsamoin14@gmail.com (type=admin, remaining=2)
INFO:db_ops_service.main:OTP stored for hafsamoin14@gmail.com (type=admin, expires in 600s)
INFO:auth_service.main:✅ Email sent successfully to hafsamoin14@gmail.com via smtp.gmail.com:587
INFO:auth_service.main:✅ OTP email sent successfully via SMTP to hafsamoin14@gmail.com
INFO:auth_service.main:OTP sent to hafsamoin14@gmail.com (type=admin)
INFO:db_ops_service.main:OTP rate limit check passed for hafsamoin14@gmail.com (type=admin, remaining=1)
INFO:db_ops_service.main:OTP stored for hafsamoin14@gmail.com (type=admin, expires in 600s)
INFO:auth_service.main:✅ Email sent successfully to hafsamoin14@gmail.com via smtp.gmail.com:587
INFO:auth_service.main:✅ OTP email sent successfully via SMTP to hafsamoin14@gmail.com
INFO:auth_service.main:OTP sent to hafsamoin14@gmail.com (type=admin)
INFO:db_ops_service.main:OTP rate limit check passed for hafsamoin14@gmail.com (type=admin, remaining=0)
INFO:db_ops_service.main:OTP stored for hafsamoin14@gmail.com (type=admin, expires in 600s)
INFO:auth_service.main:✅ Email sent successfully to hafsamoin14@gmail.com via smtp.gmail.com:587
INFO:auth_service.main:✅ OTP email sent successfully via SMTP to hafsamoin14@gmail.com
INFO:auth_service.main:OTP sent to hafsamoin14@gmail.com (type=admin)
WARNING:db_ops_service.main:OTP rate limit exceeded for hafsamoin14@gmail.com (type=admin)
